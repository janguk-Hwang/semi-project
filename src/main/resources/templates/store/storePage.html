<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" th:href="@{/landing.css}">
    <title>store/storePage.html</title>
    <style>
        .item-list {
            width: 100%;
            margin: 20px auto;
            background-color: #cfd8dc;
        }
        .store-title h2{
            font-size: 28px;
            margin-bottom: 20px;
            text-align: center;
        }
        .category{
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        .category button {
            padding: 6px 14px;
            border: 1px solid #ccc;
            background-color: #fff;
            cursor: pointer;
        }
        .category button:hover{
            background-color: #eee;
        }
        .count{
            font-size: 14px;
            margin-bottom: 10px;
            color: #555;
        }
        .product-list {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 30px;
            margin-top: 30px;
        }

        .pagination{
            margin-top: 40px;
            text-align: center;
        }
        .pagination a{
            margin: 0 5px;
            text-decoration: none;
            color: #333;
        }
        .artist-list ul{
            display: flex;
            flex-wrap: wrap; /*가로가 넘치면 줄바꿈 허용*/
            gap: 12px 20px;
            padding: 0;
            margin-top: 10px;
        }
        .artist-list li{
            list-style: none;
        }
        .artist-list a{
            display: inline-block;
            padding: 6px 12px;
            border: 1px solid #bbb;
            border-radius: 4px;
            font-size: 14px;
            color: #333;
            text-decoration: none;
        }
        .artist-list a:hover{
            background-color: #eee;
        }
    </style>
</head>
<body>
<!--헤더삽입-->
<div th:replace="~{fragments/layout::header}"></div>

<!-- 메인 콘텐츠 영역: th:block으로 감싸서 중복 출력을 방지합니다 -->
<th:block th:replace="~{fragments/layout::getMain(~{::content})}">
    <div th:fragment="content" class="item-list">
        <section class="store-title">
            <h2 th:if="${mode=='artist' and artist_name!=null}" th:text="${artist_name}">선택한 아티스트 이름</h2>
        </section>
        <section class="category">
            <a th:href="@{/store}"><button class="allitems">전체보기</button></a>
            <a th:href="@{/store/category/album(pageNum=1)}"><button class="album">ALBUM</button></a>
            <a th:href="@{/store/category/md(pageNum=1)}"><button class="md">MD</button></a>
            <a th:href="@{/store(mode='artist')}"><button class="artist" >ARTIST</button></a>
        </section>
        <section class="artist-list" th:if="${mode=='artist'}">
            <ul>
                <li th:each="artist:${artists}">
                    <a th:href="@{/store/artist/{id}(id=${artist.artist_id})}"
                       th:text="${artist.artist_name}"></a>
                </li>
            </ul>
        </section>
        <section class="count">
            <p>total <span th:text="${totalCount}">0</span> items</p>
        </section>
        <hr>
        <section class="product-list">
            <div class="product-card" th:each="products:${products}">
                <a th:href="@{/store/storeItem/{product_id}(product_id=${products.product_id})}">
                    <img th:src="@{'/images/' + ${products.savefilename}}" alt="상품이미지">
                    <p class="name" th:text="${products.product_name}"></p>
                    <p class="price" th:text="${products.price}"></p>
                </a>
            </div>
        </section>
        <section class="pagination" th:if="${pageInfo!=null}">
            <!-- 전체 / album / md용 -->
            <th:block th:if="${mode==null}">
                <li th:if="${pageInfo.startPageNum>1}">
                    <a th:href="@{/store/{product_type}(product_type=${product_type}, pageNum=${pageInfo.startPageNum - 1})}">[이전]</a>
                </li>
                <li th:each="pagenum:${#numbers.sequence(pageInfo.startPageNum,pageInfo.endPageNum)}">
                    <a th:href="@{/store/{product_type}(product_type=${product_type}, pageNum=${pagenum})}">[[${pagenum}]]</a>
                </li>
                <li th:if="${pageInfo.endPageNum<pageInfo.totalPageCount}">
                    <a th:href="@{/store/{product_type}(product_type=${product_type}, pageNum=${pageInfo.endPageNum + 1})}">[다음]</a>
                </li>
            </th:block>
            <!-- 아티스트용 -->
            <th:block th:if="${mode=='artist'}">
                <li th:if="${pageInfo.startPageNum>1}">
                    <a th:href="@{/store/artist/{artist_id}(artist_id=${artist_id}, pageNum=${pageInfo.startPageNum - 1})}">[이전]</a>
                </li>
                <li th:each="pagenum:${#numbers.sequence(pageInfo.startPageNum,pageInfo.endPageNum)}">
                    <a th:href="@{/store/artist/{artist_id}(artist_id=${artist_id}, pageNum=${pagenum})}">[[${pagenum}]]</a>
                </li>
                <li th:if="${pageInfo.endPageNum<pageInfo.totalPageCount}">
                    <a th:href="@{/store/artist/{artist_id}(artist_id=${artist_id},pageNum=${pageInfo.endPageNum + 1})}">[다음]</a>
                </li>
            </th:block>
        </section>
    </div>
</th:block>
<!--푸터삽입-->
<div th:replace="~{fragments/layout::footer}"></div>
</body>
</html>