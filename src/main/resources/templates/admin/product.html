<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>admin/product.html</title>
  <link rel="stylesheet" th:href="@{/landing.css}">
  <link rel="stylesheet" th:href="@{/admin-product.css}">
</head>
<body>
<!-- header -->
<div th:replace="fragments/layout :: header"></div>
<div id="homeContent" class="pm-page">

  <!-- 상단 탭(관리자 메뉴) -->
  <nav class="pm-tabs">
    <a class="tab" th:href="@{/admin/main}">전체관리</a>
    <a class="tab" th:href="@{/admin/board}">게시물관리</a>
    <a class="tab is-active" th:href="@{/admin/product}">상품관리</a>
    <a class="tab" th:href="@{/admin/stock}">재고관리</a>
    <a class="tab" th:href="@{/admin/usermanagement}">회원관리</a>
    <a class="tab" th:href="@{/admin/artistmanagement}">아티스트관리</a>
  </nav>

  <!-- 타이틀 + 버튼 -->
  <div class="pm-head">
    <h2 class="pm-title">상품 관리</h2>

    <!-- 실제 이동 경로는 네 프로젝트에 맞게 수정 -->
    <a class="pm-add-btn" th:href="@{/admin/product/new}">
      + 상품 등록
    </a>
  </div>

  <!-- 테이블 카드 -->
  <section class="pm-card">
    <table class="pm-table">
      <thead>
      <tr>
        <th class="col-check"></th>
        <th class="col-img">상품 이미지</th>
        <th class="col-name">상품명</th>
        <th class="col-cat">카테고리</th>
        <th class="col-price">가격</th>
        <th class="col-stock">재고</th>
      </tr>
      </thead>

      <!--  등록된 상품들의 행 -->
      <tbody>
      <tr th:each="p:${list}">
        <td class="col-check"><input type="checkbox"></td>
        <td class="col-img">
          <img class="img-box"
               th:src="@{/images/{f}(f=${p.savefilename})}"
               alt="thumb">
        </td>
        <input type="hidden" name="product_id" th:value="${p.product_id}">
        <td class="col-name" th:text="${p.product_name}"></td>
        <td class="col-cat" th:text="${p.product_type}"></td>
        <td class="col-price" th:text="${p.price}"></td>
        <td class="col-stock" th:text="${p.stock}"></td>
      </tr>
      </tbody>
    </table>
  </section>
  <form th:action="@{/admin/product}" method="get">

    <!-- 검색하면 보통 1페이지부터 -->
    <input type="hidden" name="pageNum" value="1">

    <!-- 검색 옵션(라디오) -->
    <div class="search-options">
      <label class="opt">
        <input type="radio" name="field" value="product_name"
               th:checked="${field == null || field == 'product_name'}">
        상품명
      </label>
      <label class="opt">
        <input type="radio" name="field" value="product_type"
               th:checked="${field == 'product_type'}">
        카테고리
      </label>
      <label class="opt">
        <input type="radio" name="field" value="price"
               th:checked="${field == 'price'}">
        가격
      </label>
    </div>

    <!-- 검색 바 -->
    <div class="search-bar">
      <input type="text" class="search-input" name="keyword"
             th:value="${keyword}" placeholder="Search">
      <button type="submit" class="search-btn">검색</button>
    </div>

  </form>



  <!-- 페이지네이션 -->
  <nav class="pager" aria-label="Pagination" th:if="${pageInfo.totalPageCount > 0}">

    <!-- 이전 블록(‹) : startPageNum-1 로 이동 -->
    <a class="pbtn"
       th:classappend="${pageInfo.startPageNum == 1} ? ' disabled' : ''"
       th:href="${pageInfo.startPageNum == 1} ? '#' :
              @{/admin/product(pageNum=${pageInfo.startPageNum - 1},
                            field=${field},
                            keyword=${keyword})}">
      ‹
    </a>

    <!-- 페이지 번호 -->
    <a class="pnum"
       th:each="p : ${#numbers.sequence(pageInfo.startPageNum, pageInfo.endPageNum)}"
       th:text="${p}"
       th:classappend="${p == pageInfo.pageNum} ? ' is-active' : ''"
       th:href="@{/admin/product(pageNum=${p},
                             field=${field},
                             keyword=${keyword})}">
    </a>

    <!-- 다음 블록(›) : endPageNum+1 로 이동 -->
    <a class="pbtn"
       th:classappend="${pageInfo.endPageNum == pageInfo.totalPageCount} ? ' disabled' : ''"
       th:href="${pageInfo.endPageNum == pageInfo.totalPageCount} ? '#' :
              @{/admin/product(pageNum=${pageInfo.endPageNum + 1},
                            field=${field},
                            keyword=${keyword})}">
      ›
    </a>

  </nav>

</div>
<!-- footer -->
<div th:replace="fragments/layout :: footer"></div>

<script th:inline="javascript" th:if="${msg}">
  alert([[${msg}]]);
</script>
</body>
</html>